import 'dart:async';
import 'dart:convert';

import 'package:fingraph/model/asset.dart';
import 'package:fingraph/model/dimension.dart';
import 'package:fingraph/model/dimension_type.dart';
import 'package:fingraph/model/ohlc.dart';
import 'package:fingraph/model/request_args.dart';
import 'package:fingraph/model/src_api.dart';
import 'package:fingraph/model/tick.dart';
import 'package:fingraph/model/wsmsg.dart';
import 'package:fingraph/utils/const.dart';

class TestData<T extends Dimension> extends SrcApi {
  @override
  RequestArgs _requestArgs;
  RequestArgs get requestArgs => _requestArgs;
  set requestArgs(RequestArgs requestArgs) {
    _requestArgs = requestArgs;
  }

  TestData() {
    print("* testdata()");
  }

  DateTime _dt = DateTime.now();
  StreamSubscription<dynamic> _sub;

  Stream<String> _dimensionStream(DateTime dt) async* {
    WsMsg msg;
    DateTime _dt = dt;
    try {
      for(var i=0; i < kMaxLenData; i++) {
        await Future.delayed(Dimension.addDt);

        if(_requestArgs.type == DimensionType.tick) {
          Tick tick =  Tick().getRandom(_dt);
          _dt = _dt.add(Dimension.addDt);
          msg = WsMsg(jsonrpc: 2, method: "q", params: tick); //json.encode(tick.toJson()));
        } else {
          Ohlc ohlc =  Ohlc().getRandom(_dt);
          _dt = _dt.add(Dimension.addDt);
          msg = WsMsg(jsonrpc: 2, method: "o", params: ohlc); //json.encode(tick.toJson()));
        }

        //print("* testdata.dataStream: ${msg.toString()}");
        yield json.encode(msg.toJson());
      }
    } catch (e) {
      print("* _tickStream.error: ${e.toString()}");
    }
  }

  @override
  bool start(String symbol, OnData onData, {OnError onError}) {
    bool res = false;
    print("* testdata.start");
    try {
      final Stream<String> stream = _dimensionStream(_dt);
      if(_sub != null) _sub.cancel();
      _sub = stream.listen(onData, onError: onError ?? _onError, onDone: _onDone);
      res = true;
    } catch (e) {
      print("* testdata.catch error: ${e.toString()}");
    }
    return res;
  }
  //void _testData(dynamic msg) => print("* testdata.onData: $msg");
  void _onError(Object error) => print("* testdata._onError: $error");

  void _onDone() {
    _sub?.cancel();
    print("* testdata._onDone");
  }

  @override
  void stop() {
    _sub?.cancel();
    print("* testdata.stop");
  }

  @override
  Future<List<Asset>> getAssets() async {
    List<Asset> assets = [];
    String jsonString = '[{"id":151,"rate":0.75,"rate_longer_5m":0.77,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-31T05:00:00Z","symbol":"EUR/GBP:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"EUR/GBP","is_otc":false,"sparkline":null},{"id":299,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T19:00:00Z","session_end_time":"2021-05-31T06:00:00Z","next_session_start_time":"2021-05-28T19:00:00Z","symbol":"GBP/JPY:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"GBP/JPY:OTC","is_otc":true,"sparkline":null},{"id":300,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"0001-01-01T00:00:00Z","session_end_time":"0001-01-01T00:00:00Z","next_session_start_time":"0001-01-01T00:00:00Z","symbol":"USD/PLN:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"USD/PLN:OTC","is_otc":true,"sparkline":null},{"id":301,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-31T00:00:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"AUD/JPY:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"AUD/JPY:OTC","is_otc":true,"sparkline":null},{"id":302,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:00:00Z","session_end_time":"2021-05-31T04:00:00Z","next_session_start_time":"2021-05-28T18:00:00Z","symbol":"USD/NOK:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"USD/NOK:OTC","is_otc":true,"sparkline":null},{"id":303,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T05:50:00Z","session_end_time":"2021-05-31T06:00:00Z","next_session_start_time":"2021-05-28T15:00:00Z","symbol":"CHF/JPY:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"CHF/JPY:OTC","is_otc":true,"sparkline":null},{"id":304,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"0001-01-01T00:00:00Z","session_end_time":"0001-01-01T00:00:00Z","next_session_start_time":"0001-01-01T00:00:00Z","symbol":"USD/BRL:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"USD/BRL:OTC","is_otc":true,"sparkline":null},{"id":305,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-31T05:00:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"CAD/CHF:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"CAD/CHF:OTC","is_otc":true,"sparkline":null},{"id":23,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T20:00:00Z","session_end_time":"2021-05-30T23:59:00Z","next_session_start_time":"2021-05-28T20:00:00Z","symbol":"EUR/USD:OTC","SessionSource":"manual","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"EUR/USD:OTC","is_otc":true,"sparkline":null},{"id":29,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-30T23:55:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"USD/CHF:OTC","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/CHF:OTC","is_otc":true,"sparkline":null},{"id":318,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"YNDX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"YNDX","is_otc":false,"sparkline":null},{"id":319,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"BIDU:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"BIDU:BFX","is_otc":false,"sparkline":null},{"id":320,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"MCD:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"MCD:BFX","is_otc":false,"sparkline":null},{"id":321,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"C:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"C:BFX","is_otc":false,"sparkline":null},{"id":322,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"MSFT:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"MSFT:BFX","is_otc":false,"sparkline":null},{"id":323,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"BABA:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"BABA:BFX","is_otc":false,"sparkline":null},{"id":324,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"AMZN:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"AMZN:BFX","is_otc":false,"sparkline":null},{"id":325,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"TSLA:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"TSLA:BFX","is_otc":false,"sparkline":null},{"id":326,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"JPM:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"JPM:BFX","is_otc":false,"sparkline":null},{"id":327,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"INTC:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"INTC:BFX","is_otc":false,"sparkline":null},{"id":328,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"FB:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"FB:BFX","is_otc":false,"sparkline":null},{"id":329,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"AAPL:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"AAPL:BFX","is_otc":false,"sparkline":null},{"id":330,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"GOOG:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"GOOG:BFX","is_otc":false,"sparkline":null},{"id":331,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"MS:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"MS:BFX","is_otc":false,"sparkline":null},{"id":332,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"NKE:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"NKE:BFX","is_otc":false,"sparkline":null},{"id":333,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"KO:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"KO:BFX","is_otc":false,"sparkline":null},{"id":334,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"GS:BFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"STOCKS","deals_opening_allowed":true,"friendly_name":"GS:BFX","is_otc":false,"sparkline":null},{"id":113,"rate":0,"rate_longer_5m":0.77,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-31T05:00:00Z","symbol":"GBP/CAD:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"GBP/CAD","is_otc":false,"sparkline":null},{"id":306,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-31T06:00:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"CAD/JPY:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"CAD/JPY:OTC","is_otc":true,"sparkline":null},{"id":307,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-31T05:00:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"EUR/GBP:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"EUR/GBP:OTC","is_otc":true,"sparkline":null},{"id":308,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-31T00:00:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"NZD/USD:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"NZD/USD:OTC","is_otc":true,"sparkline":null},{"id":309,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-31T05:00:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"GBP/CAD:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"GBP/CAD:OTC","is_otc":true,"sparkline":null},{"id":310,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-27T18:00:00Z","session_end_time":"2021-05-28T07:00:00Z","next_session_start_time":"2021-05-28T18:00:00Z","symbol":"AUD/CAD:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"AUD/CAD:OTC","is_otc":true,"sparkline":null},{"id":311,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-31T04:00:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"GBP/NZD:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"GBP/NZD:OTC","is_otc":true,"sparkline":null},{"id":312,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:00:00Z","session_end_time":"2021-05-31T05:00:00Z","next_session_start_time":"2021-05-28T18:00:00Z","symbol":"GBP/CHF:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"GBP/CAD:OTC","is_otc":true,"sparkline":null},{"id":313,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:00:00Z","session_end_time":"2021-05-31T04:00:00Z","next_session_start_time":"2021-05-28T18:00:00Z","symbol":"AUD/CHF:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"AUD/CHF:OTC","is_otc":true,"sparkline":null},{"id":314,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"0001-01-01T00:00:00Z","session_end_time":"0001-01-01T00:00:00Z","next_session_start_time":"0001-01-01T00:00:00Z","symbol":"USD/TRY:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"USD/TRY:OTC","is_otc":true,"sparkline":null},{"id":286,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"GS","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Goldman Sachs","is_otc":false,"sparkline":null},{"id":315,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:00:00Z","session_end_time":"2021-05-31T04:00:00Z","next_session_start_time":"2021-05-28T18:00:00Z","symbol":"AUD/NZD:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"AUD/NZD:OTC","is_otc":true,"sparkline":null},{"id":209,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"0001-01-01T00:00:00Z","session_end_time":"0001-01-01T00:00:00Z","next_session_start_time":"0001-01-01T00:00:00Z","symbol":"USD/TRY:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/TRY","is_otc":false,"sparkline":null},{"id":316,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"0001-01-01T00:00:00Z","session_end_time":"0001-01-01T00:00:00Z","next_session_start_time":"0001-01-01T00:00:00Z","symbol":"USD/SGD:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"USD/SGD:OTC","is_otc":true,"sparkline":null},{"id":190,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-31T06:00:00Z","symbol":"CAD/JPY:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"CAD/JPY","is_otc":false,"sparkline":null},{"id":317,"rate":0.55,"rate_longer_5m":0.44,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-31T05:00:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"GBP/AUD:OTC","SessionSource":"inverted_parent","RateSource":"manual","enabled":false,"category":"Forex","deals_opening_allowed":false,"friendly_name":"GBP/AUD:OTC","is_otc":true,"sparkline":null},{"id":30,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-25T16:14:00Z","session_end_time":"2021-05-25T18:55:00Z","next_session_start_time":"2021-06-01T15:25:00Z","symbol":"USD/JPY:OTC","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/JPY:OTC","is_otc":true,"sparkline":null},{"id":24,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-30T23:55:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"AUD/USD:OTC","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"AUD/USD:OTC","is_otc":true,"sparkline":null},{"id":253,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T15:00:00Z","next_session_start_time":"2021-05-31T06:00:00Z","symbol":"CHF/JPY:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"CHF/JPY","is_otc":false,"sparkline":null},{"id":162,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"0001-01-01T00:00:00Z","session_end_time":"0001-01-01T00:00:00Z","next_session_start_time":"0001-01-01T00:00:00Z","symbol":"USD/SGD:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/SGD","is_otc":false,"sparkline":null},{"id":25,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-25T16:14:00Z","session_end_time":"2021-05-25T18:55:00Z","next_session_start_time":"2021-06-01T15:25:00Z","symbol":"EUR/CHF:OTC","SessionSource":"parser","RateSource":"parser","enabled":false,"category":"Forex","deals_opening_allowed":true,"friendly_name":"EUR/CHF:OTC","is_otc":true,"sparkline":null},{"id":278,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-25T16:14:00Z","session_end_time":"2021-05-25T18:55:00Z","next_session_start_time":"2021-06-01T15:25:00Z","symbol":"CO1.COM:TEI","SessionSource":"parser","RateSource":"parser","enabled":false,"category":"Commodities","deals_opening_allowed":true,"friendly_name":"Brent Oil","is_otc":false,"sparkline":null},{"id":280,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-25T16:14:00Z","session_end_time":"2021-05-25T18:55:00Z","next_session_start_time":"2021-06-01T15:25:00Z","symbol":"XAGUSD.CUR:TEI","SessionSource":"parser","RateSource":"parser","enabled":false,"category":"Commodities","deals_opening_allowed":true,"friendly_name":"Silver","is_otc":false,"sparkline":null},{"id":271,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-25T16:14:00Z","session_end_time":"2021-05-25T18:55:00Z","next_session_start_time":"2021-06-01T15:25:00Z","symbol":"XAUUSD.CUR:TEI","SessionSource":"parser","RateSource":"parser","enabled":false,"category":"Commodities","deals_opening_allowed":true,"friendly_name":"Gold","is_otc":false,"sparkline":null},{"id":26,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-30T23:55:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"EUR/JPY:OTC","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"EUR/JPY:OTC","is_otc":true,"sparkline":null},{"id":187,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"0001-01-01T00:00:00Z","session_end_time":"0001-01-01T00:00:00Z","next_session_start_time":"0001-01-01T00:00:00Z","symbol":"USD/PLN:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/PLN","is_otc":false,"sparkline":null},{"id":179,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T19:00:00Z","next_session_start_time":"2021-05-31T06:00:00Z","symbol":"GBP/JPY:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"GBP/JPY","is_otc":false,"sparkline":null},{"id":279,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-25T16:14:00Z","session_end_time":"2021-05-25T18:55:00Z","next_session_start_time":"2021-06-01T15:25:00Z","symbol":"CL1.COM:TEI","SessionSource":"parser","RateSource":"parser","enabled":false,"category":"Commodities","deals_opening_allowed":true,"friendly_name":"Crude Oil","is_otc":false,"sparkline":null},{"id":201,"rate":0,"rate_longer_5m":0.78,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:00:00Z","next_session_start_time":"2021-05-31T04:00:00Z","symbol":"AUD/NZD:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"AUD/NZD","is_otc":false,"sparkline":null},{"id":249,"rate":0,"rate_longer_5m":0.77,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:00:00Z","next_session_start_time":"2021-05-31T05:00:00Z","symbol":"GBP/CHF:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"GBP/CHF","is_otc":false,"sparkline":null},{"id":123,"rate":0,"rate_longer_5m":0.78,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:00:00Z","next_session_start_time":"2021-05-31T04:00:00Z","symbol":"USD/NOK:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/NOK","is_otc":false,"sparkline":null},{"id":124,"rate":0,"rate_longer_5m":0.78,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-31T00:00:00Z","symbol":"AUD/JPY:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"AUD/JPY","is_otc":false,"sparkline":null},{"id":289,"rate":0.55,"rate_longer_5m":0.44,"available":true,"session_start_time":"2021-05-25T10:10:00Z","session_end_time":"2021-05-30T23:59:00Z","next_session_start_time":"2021-06-01T10:10:00Z","symbol":"AMZN","SessionSource":"manual","RateSource":"manual","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Amazon","is_otc":false,"sparkline":null},{"id":141,"rate":0.75,"rate_longer_5m":0,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-31T00:00:00Z","symbol":"USD/JPY:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/JPY","is_otc":false,"sparkline":null},{"id":67,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T07:00:00Z","session_end_time":"2021-05-28T18:00:00Z","next_session_start_time":"2021-05-28T07:00:00Z","symbol":"AUD/CAD:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"AUD/CAD","is_otc":false,"sparkline":null},{"id":291,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"INTC","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Intel","is_otc":false,"sparkline":null},{"id":294,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"GOOG","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Google","is_otc":false,"sparkline":null},{"id":292,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"BIDU","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Baidu","is_otc":false,"sparkline":null},{"id":285,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"KO","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Coca-Cola","is_otc":false,"sparkline":null},{"id":288,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"AAPL","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Apple","is_otc":false,"sparkline":null},{"id":293,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"C","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Citigroup","is_otc":false,"sparkline":null},{"id":222,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T07:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T07:00:00Z","symbol":"USD/CHF:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/CHF","is_otc":false,"sparkline":null},{"id":107,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-25T16:14:00Z","session_end_time":"2021-05-25T18:55:00Z","next_session_start_time":"2021-06-01T15:25:00Z","symbol":"GBP/USD:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"GBP/USD","is_otc":false,"sparkline":null},{"id":295,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"MCD","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Mcdonald\'s","is_otc":false,"sparkline":null},{"id":254,"rate":0,"rate_longer_5m":0.78,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-31T05:00:00Z","symbol":"CAD/CHF:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"CAD/CHF","is_otc":false,"sparkline":null},{"id":284,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"MSFT","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Microsoft","is_otc":false,"sparkline":null},{"id":236,"rate":0.76,"rate_longer_5m":0.72,"available":false,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-31T00:00:00Z","symbol":"EUR/USD:AFX","SessionSource":"parser","RateSource":"parser","enabled":false,"category":"Forex","deals_opening_allowed":true,"friendly_name":"EUR/USD","is_otc":false,"sparkline":null},{"id":27,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T18:30:00Z","session_end_time":"2021-05-30T23:55:00Z","next_session_start_time":"2021-05-28T18:30:00Z","symbol":"GBP/USD:OTC","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"GBP/USD:OTC","is_otc":true,"sparkline":null},{"id":298,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"NKE","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Nike","is_otc":false,"sparkline":null},{"id":28,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-25T16:14:00Z","session_end_time":"2021-05-25T18:55:00Z","next_session_start_time":"2021-06-01T15:25:00Z","symbol":"USD/CAD:OTC","SessionSource":"parser","RateSource":"parser","enabled":false,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/CAD:OTC","is_otc":true,"sparkline":null},{"id":207,"rate":0,"rate_longer_5m":0.78,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:00:00Z","next_session_start_time":"2021-05-31T04:00:00Z","symbol":"AUD/CHF:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"AUD/CHF","is_otc":false,"sparkline":null},{"id":148,"rate":0,"rate_longer_5m":0.78,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-31T05:00:00Z","symbol":"GBP/AUD:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"GBP/AUD","is_otc":false,"sparkline":null},{"id":297,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"JPM","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"JPMorgan Chase \u0026 Co.","is_otc":false,"sparkline":null},{"id":287,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:40:00Z","session_end_time":"2021-05-30T23:59:00Z","next_session_start_time":"2021-05-28T13:40:00Z","symbol":"MS","SessionSource":"manual","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Morgan Stanley","is_otc":false,"sparkline":null},{"id":282,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"TSLA","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Tesla","is_otc":false,"sparkline":null},{"id":56,"rate":0,"rate_longer_5m":0.58,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T17:00:00Z","next_session_start_time":"2021-05-31T00:00:00Z","symbol":"AUD/USD:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"AUD/USD","is_otc":false,"sparkline":null},{"id":283,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"FB","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Facebook","is_otc":false,"sparkline":null},{"id":290,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T13:33:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-28T13:33:00Z","symbol":"TWTR","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Stocks","deals_opening_allowed":true,"friendly_name":"Twitter","is_otc":false,"sparkline":null},{"id":81,"rate":0,"rate_longer_5m":0,"available":false,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T16:00:00Z","next_session_start_time":"2021-05-31T06:00:00Z","symbol":"USD/CAD:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"USD/CAD","is_otc":false,"sparkline":null},{"id":61,"rate":0.76,"rate_longer_5m":0.77,"available":true,"session_start_time":"2021-05-28T06:00:00Z","session_end_time":"2021-05-28T18:30:00Z","next_session_start_time":"2021-05-31T00:00:00Z","symbol":"EUR/JPY:AFX","SessionSource":"parser","RateSource":"parser","enabled":true,"category":"Forex","deals_opening_allowed":true,"friendly_name":"EUR/JPY","is_otc":false,"sparkline":null}]';
    for (var a in json.decode(jsonString)) {
      assets.add(Asset.fromJson(a));
    }
    return assets;
  }

  @override
  Future<List<dynamic>> getHistory(RequestArgs ra) {
    List<dynamic> data = [];
    String jsonString;
    DateTime dt;
    if(ra.type == DimensionType.tick) {
      dt = _dt.subtract(Duration(seconds: 30));
      //dt = DateTime.now(); //.subtract(Duration(minutes: 5));
      jsonString = '[{"d":1620347100563,"q":0.94617},{"d":1620347101561,"q":0.94618},{"d":1620347102562,"q":0.94618},{"d":1620347103563,"q":0.94618},{"d":1620347104563,"q":0.94618},{"d":1620347105861,"q":0.94619},{"d":1620347106863,"q":0.94619},{"d":1620347107864,"q":0.94619},{"d":1620347108866,"q":0.94619},{"d":1620347109867,"q":0.94619},{"d":1620347110869,"q":0.94619},{"d":1620347111870,"q":0.94619},{"d":1620347112871,"q":0.94619},{"d":1620347113872,"q":0.94619},{"d":1620347114874,"q":0.94619},{"d":1620347115874,"q":0.94619},{"d":1620347116660,"q":0.94618},{"d":1620347117762,"q":0.94617},{"d":1620347118763,"q":0.94617},{"d":1620347119764,"q":0.94617},{"d":1620347120765,"q":0.94617},{"d":1620347121961,"q":0.94615},{"d":1620347122963,"q":0.94615},{"d":1620347123964,"q":0.94615},{"d":1620347124965,"q":0.94615},{"d":1620347125967,"q":0.94615},{"d":1620347126968,"q":0.94615},{"d":1620347127969,"q":0.94615},{"d":1620347128970,"q":0.94615},{"d":1620347129970,"q":0.94615},{"d":1620347130972,"q":0.94615},{"d":1620347131973,"q":0.94615},{"d":1620347132761,"q":0.94614},{"d":1620347133762,"q":0.94614},{"d":1620347134764,"q":0.94614},{"d":1620347135765,"q":0.94614},{"d":1620347136767,"q":0.94614},{"d":1620347137862,"q":0.94615},{"d":1620347138864,"q":0.94615},{"d":1620347139864,"q":0.94615},{"d":1620347140866,"q":0.94615},{"d":1620347141867,"q":0.94615},{"d":1620347142868,"q":0.94615},{"d":1620347143870,"q":0.94615},{"d":1620347144871,"q":0.94615},{"d":1620347145872,"q":0.94615},{"d":1620347146873,"q":0.94615},{"d":1620347147875,"q":0.94615},{"d":1620347148876,"q":0.94615},{"d":1620347149876,"q":0.94615},{"d":1620347150878,"q":0.94615},{"d":1620347151879,"q":0.94615},{"d":1620347152880,"q":0.94615},{"d":1620347153881,"q":0.94615},{"d":1620347154883,"q":0.94615},{"d":1620347155883,"q":0.94615},{"d":1620347156884,"q":0.94615},{"d":1620347157886,"q":0.94615},{"d":1620347158861,"q":0.94617},{"d":1620347159561,"q":0.94616},{"d":1620347160561,"q":0.94616},{"d":1620347161562,"q":0.94616},{"d":1620347162563,"q":0.94616},{"d":1620347163564,"q":0.94616},{"d":1620347164566,"q":0.94616},{"d":1620347165568,"q":0.94616},{"d":1620347166568,"q":0.94616},{"d":1620347167569,"q":0.94616},{"d":1620347168570,"q":0.94616},{"d":1620347169661,"q":0.94615},{"d":1620347170663,"q":0.94615},{"d":1620347171664,"q":0.94615},{"d":1620347172665,"q":0.94615},{"d":1620347173666,"q":0.94615},{"d":1620347174667,"q":0.94615},{"d":1620347175668,"q":0.94615},{"d":1620347176670,"q":0.94615},{"d":1620347177671,"q":0.94615},{"d":1620347178672,"q":0.94615},{"d":1620347179673,"q":0.94615},{"d":1620347180675,"q":0.94615},{"d":1620347181675,"q":0.94615},{"d":1620347182760,"q":0.94615},{"d":1620347183762,"q":0.94615},{"d":1620347184763,"q":0.94615},{"d":1620347185765,"q":0.94615},{"d":1620347186766,"q":0.94615},{"d":1620347187767,"q":0.94615},{"d":1620347188762,"q":0.94617},{"d":1620347189763,"q":0.94617},{"d":1620347190764,"q":0.94617},{"d":1620347191765,"q":0.94617},{"d":1620347192767,"q":0.94617},{"d":1620347193768,"q":0.94617},{"d":1620347194768,"q":0.94617},{"d":1620347195769,"q":0.94617},{"d":1620347196771,"q":0.94617},{"d":1620347197772,"q":0.94617},{"d":1620347198773,"q":0.94617},{"d":1620347199775,"q":0.94617},{"d":1620347200777,"q":0.94617},{"d":1620347201961,"q":0.94618},{"d":1620347202961,"q":0.94618},{"d":1620347203962,"q":0.94618},{"d":1620347204963,"q":0.94618},{"d":1620347205964,"q":0.94618},{"d":1620347206964,"q":0.94618},{"d":1620347207964,"q":0.94618},{"d":1620347208966,"q":0.94618},{"d":1620347209967,"q":0.94618},{"d":1620347210968,"q":0.94618},{"d":1620347211969,"q":0.94618},{"d":1620347212970,"q":0.94618},{"d":1620347213971,"q":0.94618},{"d":1620347214972,"q":0.94618},{"d":1620347215973,"q":0.94618},{"d":1620347216974,"q":0.94618},{"d":1620347217975,"q":0.94618},{"d":1620347218976,"q":0.94618},{"d":1620347219977,"q":0.94618},{"d":1620347220977,"q":0.94618},{"d":1620347221979,"q":0.94618},{"d":1620347222760,"q":0.94618},{"d":1620347223761,"q":0.94618},{"d":1620347224763,"q":0.94618},{"d":1620347225760,"q":0.94617},{"d":1620347226861,"q":0.94617},{"d":1620347227861,"q":0.94617},{"d":1620347228863,"q":0.94617},{"d":1620347229864,"q":0.94617},{"d":1620347230865,"q":0.94617},{"d":1620347231867,"q":0.94617},{"d":1620347232869,"q":0.94617},{"d":1620347233870,"q":0.94617},{"d":1620347234871,"q":0.94617},{"d":1620347235961,"q":0.94617},{"d":1620347236961,"q":0.94617},{"d":1620347237962,"q":0.94617},{"d":1620347238661,"q":0.94617},{"d":1620347239663,"q":0.94617},{"d":1620347240663,"q":0.94617},{"d":1620347241664,"q":0.94617},{"d":1620347242666,"q":0.94617},{"d":1620347243668,"q":0.94617},{"d":1620347244669,"q":0.94617},{"d":1620347245761,"q":0.94615},{"d":1620347246763,"q":0.94615},{"d":1620347247763,"q":0.94615},{"d":1620347248764,"q":0.94615},{"d":1620347249764,"q":0.94615},{"d":1620347250766,"q":0.94615},{"d":1620347251767,"q":0.94615},{"d":1620347252769,"q":0.94615},{"d":1620347253561,"q":0.94615},{"d":1620347254562,"q":0.94615},{"d":1620347255563,"q":0.94615},{"d":1620347256565,"q":0.94615},{"d":1620347257567,"q":0.94615},{"d":1620347258661,"q":0.94615},{"d":1620347259662,"q":0.94615},{"d":1620347260664,"q":0.94615},{"d":1620347261665,"q":0.94615},{"d":1620347262666,"q":0.94615},{"d":1620347263667,"q":0.94615},{"d":1620347264669,"q":0.94615},{"d":1620347265671,"q":0.94615},{"d":1620347266561,"q":0.94616},{"d":1620347267562,"q":0.94616},{"d":1620347268761,"q":0.94615},{"d":1620347269762,"q":0.94615},{"d":1620347270763,"q":0.94615},{"d":1620347271764,"q":0.94615},{"d":1620347272764,"q":0.94615},{"d":1620347273766,"q":0.94615},{"d":1620347274767,"q":0.94615},{"d":1620347275768,"q":0.94615},{"d":1620347276960,"q":0.94617},{"d":1620347277661,"q":0.94615},{"d":1620347278662,"q":0.94615},{"d":1620347279663,"q":0.94615},{"d":1620347280664,"q":0.94615},{"d":1620347281666,"q":0.94615},{"d":1620347282667,"q":0.94615},{"d":1620347283668,"q":0.94615},{"d":1620347284961,"q":0.94613},{"d":1620347285963,"q":0.94613},{"d":1620347286963,"q":0.94613},{"d":1620347287964,"q":0.94613},{"d":1620347288965,"q":0.94613},{"d":1620347289861,"q":0.94612},{"d":1620347290562,"q":0.94612},{"d":1620347291563,"q":0.94612},{"d":1620347292564,"q":0.94612},{"d":1620347293565,"q":0.94612},{"d":1620347294760,"q":0.94612},{"d":1620347295862,"q":0.94613},{"d":1620347296863,"q":0.94613},{"d":1620347297761,"q":0.94611},{"d":1620347298961,"q":0.94612},{"d":1620347299962,"q":0.94612},{"d":1620347300963,"q":0.94612},{"d":1620347301965,"q":0.94612},{"d":1620347302965,"q":0.94612},{"d":1620347303761,"q":0.94607},{"d":1620347304762,"q":0.94607},{"d":1620347305961,"q":0.94607},{"d":1620347306963,"q":0.94607},{"d":1620347307963,"q":0.94607},{"d":1620347308964,"q":0.94607},{"d":1620347309965,"q":0.94607},{"d":1620347310967,"q":0.94607},{"d":1620347311968,"q":0.94607},{"d":1620347312561,"q":0.94607},{"d":1620347313662,"q":0.94607},{"d":1620347314663,"q":0.94607},{"d":1620347315760,"q":0.94606},{"d":1620347316761,"q":0.94606},{"d":1620347317762,"q":0.94606},{"d":1620347318764,"q":0.94606},{"d":1620347319766,"q":0.94606},{"d":1620347320767,"q":0.94606},{"d":1620347321769,"q":0.94606},{"d":1620347322769,"q":0.94606},{"d":1620347323771,"q":0.94606},{"d":1620347324772,"q":0.94606},{"d":1620347325772,"q":0.94606},{"d":1620347326773,"q":0.94606},{"d":1620347327775,"q":0.94606},{"d":1620347328775,"q":0.94606},{"d":1620347329777,"q":0.94606},{"d":1620347330778,"q":0.94606},{"d":1620347331778,"q":0.94606},{"d":1620347332779,"q":0.94606},{"d":1620347333780,"q":0.94606},{"d":1620347334782,"q":0.94606},{"d":1620347335783,"q":0.94606},{"d":1620347336784,"q":0.94606},{"d":1620347337785,"q":0.94606},{"d":1620347338961,"q":0.94605},{"d":1620347339962,"q":0.94605},{"d":1620347340964,"q":0.94605},{"d":1620347341965,"q":0.94605},{"d":1620347342966,"q":0.94605},{"d":1620347343560,"q":0.94604},{"d":1620347344561,"q":0.94604},{"d":1620347345561,"q":0.94604},{"d":1620347346563,"q":0.94604},{"d":1620347347565,"q":0.94604},{"d":1620347348961,"q":0.94602},{"d":1620347349861,"q":0.94603},{"d":1620347350861,"q":0.94603},{"d":1620347351961,"q":0.94602},{"d":1620347352761,"q":0.94602},{"d":1620347353762,"q":0.94602},{"d":1620347354661,"q":0.94603},{"d":1620347355662,"q":0.94603},{"d":1620347356664,"q":0.94603},{"d":1620347357665,"q":0.94603},{"d":1620347358667,"q":0.94603},{"d":1620347359668,"q":0.94603},{"d":1620347360662,"q":0.94603},{"d":1620347361561,"q":0.94602},{"d":1620347362562,"q":0.94602},{"d":1620347363860,"q":0.94602},{"d":1620347364861,"q":0.94603},{"d":1620347365862,"q":0.94603},{"d":1620347366863,"q":0.94603},{"d":1620347367761,"q":0.94605},{"d":1620347368761,"q":0.94605},{"d":1620347369763,"q":0.94605},{"d":1620347370764,"q":0.94605},{"d":1620347371766,"q":0.94605},{"d":1620347372767,"q":0.94605},{"d":1620347373768,"q":0.94605},{"d":1620347374769,"q":0.94605},{"d":1620347375561,"q":0.94605},{"d":1620347376563,"q":0.94605},{"d":1620347377564,"q":0.94605},{"d":1620347378564,"q":0.94605},{"d":1620347379861,"q":0.94607},{"d":1620347380862,"q":0.94607},{"d":1620347381863,"q":0.94607},{"d":1620347382864,"q":0.94607},{"d":1620347383865,"q":0.94607},{"d":1620347384865,"q":0.94607},{"d":1620347385866,"q":0.94607},{"d":1620347386868,"q":0.94607},{"d":1620347387869,"q":0.94607},{"d":1620347388862,"q":0.94609},{"d":1620347389864,"q":0.94609},{"d":1620347390865,"q":0.94609},{"d":1620347391867,"q":0.94609},{"d":1620347392867,"q":0.94609},{"d":1620347393869,"q":0.94609},{"d":1620347394870,"q":0.94609},{"d":1620347395872,"q":0.94609},{"d":1620347396874,"q":0.94609},{"d":1620347397874,"q":0.94609},{"d":1620347398875,"q":0.94609},{"d":1620347399876,"q":0.94609}]';
      for (var a in json.decode(jsonString)) {
        Tick t = Tick.fromJson(a);
        dt = dt.add(Dimension.addDt);
        t.d = dt;
        data.add(t);
      }
    } else {
      dt = _dt.subtract(Duration(seconds: 9));
      jsonString = '[{"c":0.94657,"d":1620345600000,"h":0.94661,"l":0.94651,"o":0.94661},{"c":0.94655,"d":1620345610000,"h":0.94657,"l":0.94653,"o":0.94657},{"c":0.94647,"d":1620345620000,"h":0.94655,"l":0.94647,"o":0.94655},{"c":0.94661,"d":1620345630000,"h":0.94662,"l":0.94647,"o":0.94647},{"c":0.94659,"d":1620345640000,"h":0.94661,"l":0.94659,"o":0.94661},{"c":0.94658,"d":1620345650000,"h":0.94662,"l":0.94657,"o":0.94659},{"c":0.94669,"d":1620345660000,"h":0.94669,"l":0.94658,"o":0.94658},{"c":0.94661,"d":1620345670000,"h":0.94671,"l":0.94661,"o":0.94669},{"c":0.94667,"d":1620345680000,"h":0.94669,"l":0.94661,"o":0.94661},{"c":0.94663,"d":1620345690000,"h":0.94667,"l":0.94663,"o":0.94667},{"c":0.94664,"d":1620345700000,"h":0.94664,"l":0.94662,"o":0.94663},{"c":0.94659,"d":1620345710000,"h":0.94664,"l":0.94659,"o":0.94664},{"c":0.94657,"d":1620345720000,"h":0.94659,"l":0.94656,"o":0.94659},{"c":0.94661,"d":1620345730000,"h":0.94662,"l":0.94657,"o":0.94657},{"c":0.94661,"d":1620345740000,"h":0.94661,"l":0.94659,"o":0.94661},{"c":0.94665,"d":1620345750000,"h":0.94665,"l":0.94661,"o":0.94661},{"c":0.94664,"d":1620345760000,"h":0.94665,"l":0.94663,"o":0.94665},{"c":0.94664,"d":1620345770000,"h":0.94666,"l":0.94664,"o":0.94664},{"c":0.94666,"d":1620345780000,"h":0.9467,"l":0.94663,"o":0.94664},{"c":0.94667,"d":1620345790000,"h":0.94668,"l":0.94663,"o":0.94666},{"c":0.94671,"d":1620345800000,"h":0.94675,"l":0.94667,"o":0.94667},{"c":0.94676,"d":1620345810000,"h":0.94676,"l":0.94671,"o":0.94671},{"c":0.94677,"d":1620345820000,"h":0.94677,"l":0.94675,"o":0.94676},{"c":0.9467,"d":1620345830000,"h":0.94677,"l":0.94669,"o":0.94677},{"c":0.94671,"d":1620345840000,"h":0.94671,"l":0.94669,"o":0.9467},{"c":0.94671,"d":1620345850000,"h":0.94672,"l":0.94669,"o":0.94671},{"c":0.9467,"d":1620345860000,"h":0.94671,"l":0.9467,"o":0.94671},{"c":0.94668,"d":1620345870000,"h":0.94672,"l":0.94667,"o":0.9467},{"c":0.94665,"d":1620345880000,"h":0.94668,"l":0.94665,"o":0.94668},{"c":0.94665,"d":1620345890000,"h":0.94667,"l":0.94665,"o":0.94665},{"c":0.94667,"d":1620345900000,"h":0.94667,"l":0.94665,"o":0.94665},{"c":0.94667,"d":1620345910000,"h":0.94668,"l":0.94667,"o":0.94667},{"c":0.94669,"d":1620345920000,"h":0.94669,"l":0.94667,"o":0.94667},{"c":0.94671,"d":1620345930000,"h":0.94671,"l":0.94669,"o":0.94669},{"c":0.94671,"d":1620345940000,"h":0.94671,"l":0.94671,"o":0.94671},{"c":0.94669,"d":1620345950000,"h":0.94671,"l":0.94669,"o":0.94671},{"c":0.9467,"d":1620345960000,"h":0.9467,"l":0.94669,"o":0.94669},{"c":0.94669,"d":1620345970000,"h":0.9467,"l":0.94669,"o":0.9467},{"c":0.94672,"d":1620345980000,"h":0.94672,"l":0.94667,"o":0.94669},{"c":0.94671,"d":1620345990000,"h":0.94672,"l":0.94669,"o":0.94672},{"c":0.94669,"d":1620346000000,"h":0.94671,"l":0.94669,"o":0.94671},{"c":0.94667,"d":1620346010000,"h":0.94671,"l":0.94667,"o":0.94669},{"c":0.94667,"d":1620346020000,"h":0.94667,"l":0.94667,"o":0.94667},{"c":0.94678,"d":1620346030000,"h":0.94679,"l":0.94667,"o":0.94667},{"c":0.94667,"d":1620346040000,"h":0.94678,"l":0.94665,"o":0.94678},{"c":0.94663,"d":1620346050000,"h":0.94669,"l":0.94663,"o":0.94667},{"c":0.94665,"d":1620346060000,"h":0.94665,"l":0.94663,"o":0.94663},{"c":0.94665,"d":1620346070000,"h":0.94665,"l":0.94662,"o":0.94665},{"c":0.94667,"d":1620346080000,"h":0.94667,"l":0.94665,"o":0.94665},{"c":0.94663,"d":1620346090000,"h":0.94667,"l":0.94663,"o":0.94667},{"c":0.94663,"d":1620346100000,"h":0.94663,"l":0.94663,"o":0.94663},{"c":0.94664,"d":1620346110000,"h":0.94665,"l":0.94663,"o":0.94663},{"c":0.94669,"d":1620346120000,"h":0.94669,"l":0.94663,"o":0.94664},{"c":0.94667,"d":1620346130000,"h":0.94671,"l":0.94666,"o":0.94669},{"c":0.94668,"d":1620346140000,"h":0.94668,"l":0.94667,"o":0.94667},{"c":0.94664,"d":1620346150000,"h":0.94668,"l":0.94664,"o":0.94668},{"c":0.94665,"d":1620346160000,"h":0.94665,"l":0.94664,"o":0.94664},{"c":0.94662,"d":1620346170000,"h":0.94665,"l":0.94662,"o":0.94665},{"c":0.94659,"d":1620346180000,"h":0.94663,"l":0.94659,"o":0.94662},{"c":0.94663,"d":1620346190000,"h":0.94663,"l":0.94659,"o":0.94659},{"c":0.94667,"d":1620346200000,"h":0.94667,"l":0.94663,"o":0.94663},{"c":0.94667,"d":1620346210000,"h":0.94672,"l":0.94667,"o":0.94667},{"c":0.94665,"d":1620346220000,"h":0.94667,"l":0.94665,"o":0.94667},{"c":0.94666,"d":1620346230000,"h":0.94667,"l":0.94663,"o":0.94665},{"c":0.9466,"d":1620346240000,"h":0.94666,"l":0.9466,"o":0.94666},{"c":0.94661,"d":1620346250000,"h":0.94661,"l":0.9466,"o":0.9466},{"c":0.94657,"d":1620346260000,"h":0.94661,"l":0.94656,"o":0.94661},{"c":0.94656,"d":1620346270000,"h":0.94658,"l":0.94656,"o":0.94657},{"c":0.94657,"d":1620346280000,"h":0.94657,"l":0.94655,"o":0.94656},{"c":0.94657,"d":1620346290000,"h":0.94657,"l":0.94657,"o":0.94657},{"c":0.94649,"d":1620346300000,"h":0.94657,"l":0.94649,"o":0.94657},{"c":0.94649,"d":1620346310000,"h":0.94651,"l":0.94649,"o":0.94649},{"c":0.94635,"d":1620346320000,"h":0.94649,"l":0.94635,"o":0.94649},{"c":0.94639,"d":1620346330000,"h":0.9464,"l":0.94635,"o":0.94635},{"c":0.94638,"d":1620346340000,"h":0.94639,"l":0.94635,"o":0.94639},{"c":0.94641,"d":1620346350000,"h":0.94642,"l":0.94637,"o":0.94638},{"c":0.94639,"d":1620346360000,"h":0.94641,"l":0.94639,"o":0.94641},{"c":0.94639,"d":1620346370000,"h":0.94639,"l":0.94639,"o":0.94639},{"c":0.94645,"d":1620346380000,"h":0.94646,"l":0.94639,"o":0.94639},{"c":0.94643,"d":1620346390000,"h":0.94645,"l":0.94643,"o":0.94645},{"c":0.94645,"d":1620346400000,"h":0.94645,"l":0.94643,"o":0.94643},{"c":0.94645,"d":1620346410000,"h":0.94645,"l":0.94644,"o":0.94645},{"c":0.94647,"d":1620346420000,"h":0.94648,"l":0.94645,"o":0.94645},{"c":0.94645,"d":1620346430000,"h":0.94647,"l":0.94644,"o":0.94647},{"c":0.94642,"d":1620346440000,"h":0.94645,"l":0.94642,"o":0.94645},{"c":0.94641,"d":1620346450000,"h":0.94642,"l":0.94641,"o":0.94642},{"c":0.94641,"d":1620346460000,"h":0.94641,"l":0.94641,"o":0.94641},{"c":0.94641,"d":1620346470000,"h":0.94641,"l":0.94641,"o":0.94641},{"c":0.94637,"d":1620346480000,"h":0.94641,"l":0.94637,"o":0.94641},{"c":0.94637,"d":1620346490000,"h":0.94637,"l":0.94637,"o":0.94637}]';
      for (var a in json.decode(jsonString)) {
        Ohlc o = Ohlc.fromJson(a);
        dt = dt.add(Dimension.addDt);
        o.d = dt;
        data.add(o);
      }
    }
    return Future.value(data);
  }
}

